# Data loader configuration for inverse model training
_target_: forward.model.data_loader.Dataloader
batch_size: 32  # Batch size for training
num_workers: 0  # Number of workers for data loading
persistent_workers: false  # Keep workers alive between epochs

# Split the data into prediction set
stage:
  # Prediction set
  predict:
    # Dataset class
    _target_: forward.model.data_loader.CRTMDataset
    _recursive_: false
    # Variables to use as input
    input:
      lat: ${data.vars.predict.lat}
      lon: ${data.vars.predict.lon}
      scans: ${data.vars.predict.scans}
      pressure: ${data.vars.predict.pressure}
    # Variables to use as targets or additional inputs
    #target:
    #  # Forward model additional inputs
    #  surf: ${data.vars.predict.surf}
    #  meta: ${data.vars.predict.meta}
    # Results
    results:
      # Atmospheric profile predictions
      prof:
        # Save function
        save:
          _target_: numpy.save
          _partial_: true
          _args_:
            - ${loader.stage.predict.results.prof.load.path}
        # Load function
        load:
          _target_: forward.model.data_loader.load_npy
          path: ${paths.run_dir}/predict_prof.npy
      # Forward model simulations
      # hofx:
      #   # Save function
      #   save:
      #     _target_: numpy.save
      #     _partial_: true
      #     _args_:
      #       - ${loader.stage.predict.results.hofx.load.path}
      #   # Load function
      #   load:
      #     _target_: forward.model.data_loader.load_npy
      #     path: ${paths.run_dir}/predict_hofx.npy